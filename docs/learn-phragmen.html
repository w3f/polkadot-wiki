<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learn/learn-phragmen" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">NPoS Election Algorithms ¬∑ Polkadot Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wiki.polkadot.network/img/wiki-share-image.png"><meta data-rh="true" name="twitter:image" content="https://wiki.polkadot.network/img/wiki-share-image.png"><meta data-rh="true" property="og:url" content="https://wiki.polkadot.network/docs/learn-phragmen"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="NPoS Election Algorithms ¬∑ Polkadot Wiki"><meta data-rh="true" name="description" content="The Election Methods used in Polkadot&#x27;s NPoS Mechanism."><meta data-rh="true" property="og:description" content="The Election Methods used in Polkadot&#x27;s NPoS Mechanism."><meta data-rh="true" name="keywords" content="phragmen,sequential phragm√©n method,elections,algorithm,phragmms"><link data-rh="true" rel="icon" href="/img/Polkadot_Favicon.png"><link data-rh="true" rel="canonical" href="https://wiki.polkadot.network/docs/learn-phragmen"><link data-rh="true" rel="alternate" href="https://wiki.polkadot.network/docs/learn-phragmen" hreflang="en"><link data-rh="true" rel="alternate" href="https://wiki.polkadot.network/docs/learn-phragmen" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BEUYRRAUZN-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Polkadot Wiki" href="/opensearch.xml">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script src="https://apisa.polkadot.network/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" async data-website-id="f4bbad14-cc24-471c-8b7d-3267eafc6dc2" data-project-name="Polkadot" data-modal-title="Polkadot AI Chatbot" data-project-color="#1E1E1E" data-button-bg-color="#1C0533" data-button-text-color="white" data-project-logo="https://1000logos.net/wp-content/uploads/2022/08/Polkadot-Symbol.png" data-modal-header-bg-color="#1C0533" data-modal-title-color="white" data-modal-disclaimer="This is an AI chatbot trained to answer questions about Polkadot. As such, the answers it provides might not always be accurate or up-to-date. Please use your best judgement when evaluating its responses. Also, **please refrain from sharing any personal or private information with the bot**. By submitting a query, you agree that you have read and understood [these conditions](https://polkadot.network/legal-disclosures/). 

 **If you need further assistance, you can reach out to [Polkadot Support](https://support.polkadot.network/support/tickets/new?ticket_form=i_have_a_support_request).**" data-modal-example-questions="Where can I store my DOT?,How can I create a DOT account?,How can I stake my DOT?,How does Polkadot OpenGov work?" data-search-mode-enabled="false" data-search-mode-default="false" data-button-position-top="120px" data-button-position-right="0px" data-search-include-source-names="[&quot;Polkadot Wiki&quot;]"></script><link rel="stylesheet" href="/assets/css/styles.8f36d9b5.css">
<script src="/assets/js/runtime~main.291feb6e.js" defer="defer"></script>
<script src="/assets/js/main.4a8d0e8b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#e6007a;color:white" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Register to the Polkadot Blockchain Academy Online (PBA-X) <a href="https://pbax.polkadot.academy/offers/8XLKnGiX/checkout" target="_blank" rel="noopener noreferrer">üëâHere</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/wiki-logo.svg" alt="Polkadot Wiki" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/wiki-logo.svg" alt="Polkadot Wiki" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/explore-index">Explore</a><a class="navbar__item navbar__link" href="/docs/learn-index">Learn</a><a class="navbar__item navbar__link" href="/docs/build-guide">Build</a><a class="navbar__item navbar__link" href="/docs/maintain-index">Maintain </a><a class="navbar__item navbar__link" href="/docs/kusama-getting-started">Kusama</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/explore-index">Explore</a><button aria-label="Expand sidebar category &#x27;Explore&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/learn-index">Learn</a><button aria-label="Collapse sidebar category &#x27;Learn&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/general-index">General</a><button aria-label="Expand sidebar category &#x27;General&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-basics-index">Basics</a><button aria-label="Expand sidebar category &#x27;Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/learn-advanced-index">Advanced</a><button aria-label="Collapse sidebar category &#x27;Advanced&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-architecture">Architecture</a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-account-advanced">Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-staking-advanced">Advanced Staking Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-nft-pallets">NFT Pallets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-cryptography">Cryptography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/learn-phragmen">NPoS Election Algorithms</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-polkadotjs">Polkadot-JS</a><button aria-label="Expand sidebar category &#x27;Polkadot-JS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/xcm">XCM Docs</a><button aria-label="Expand sidebar category &#x27;XCM Docs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-comparisons">Comparisons</a><button aria-label="Expand sidebar category &#x27;Comparisons&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-video-tutorials">Videos</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-future-implementations-index">Future Implementations</a><button aria-label="Expand sidebar category &#x27;Future Implementations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn-archive">Archive</a><button aria-label="Expand sidebar category &#x27;Archive&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/build-guide">Build</a><button aria-label="Expand sidebar category &#x27;Build&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/maintain-index">Maintain</a><button aria-label="Expand sidebar category &#x27;Maintain&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/kusama-getting-started">Kusama</a><button aria-label="Expand sidebar category &#x27;Kusama&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/learn-index"><span itemprop="name">Learn</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/learn-advanced-index"><span itemprop="name">Advanced</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">NPoS Election Algorithms</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>NPoS Election Algorithms</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="npos-election-algorithms">NPoS Election Algorithms<a href="#npos-election-algorithms" class="hash-link" aria-label="Direct link to NPoS Election Algorithms" title="Direct link to NPoS Election Algorithms">‚Äã</a></h2>
<p>Since validators are paid almost equally in each era, it is important that the stake behind each
validator is uniformly spread out. An election algorithm for Nominated Proof of Staking (NPoS) will
try to optimize three metrics when computing a solution graph of nominators and validators:</p>
<ol>
<li>Maximize the total amount at stake.</li>
<li>Maximize the stake behind the minimally staked validator.</li>
<li>Minimize the variance of the stake in the set.</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p><a href="#understanding-phragm%C3%A9n">Sequential Phragm√©n</a>, <a href="#phragmms-fka-balphragmms">Phragmms</a> and
<a href="https://crates.parity.io/sp_npos_elections/balancing/fn.balance.html" target="_blank" rel="noopener noreferrer">Star balancing</a> are a few
notable algorithms used for computing the NPoS solutions in Polkadot and Kusama.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-sequential-phragm√©n-method">What is the sequential Phragm√©n method?<a href="#what-is-the-sequential-phragm√©n-method" class="hash-link" aria-label="Direct link to What is the sequential Phragm√©n method?" title="Direct link to What is the sequential Phragm√©n method?">‚Äã</a></h2>
<p>The sequential Phragm√©n method is a multi-winner election method introduced by Edvard Phragm√©n in
the 1890s. The quote below taken from the reference <a href="#external-resources">Phragm√©n paper</a> sums up
the purpose of the sequential Phragm√©n method:</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The problem that Phragm√©n‚Äôs methods try to solve is that of electing a set of a given numbers of
persons from a larger set of candidates. Phragm√©n discussed this in the context of a parliamentary
election in a multi-member constituency; the same problem can, of course, also occur in local
elections, but also in many other situations such as electing a board or a committee in an
organization.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validator-elections">Validator Elections<a href="#validator-elections" class="hash-link" aria-label="Direct link to Validator Elections" title="Direct link to Validator Elections">‚Äã</a></h3>
<p>The sequential Phragm√©n is one of the methods used in the Nominated Proof-of-Stake scheme to elect
validators based on their own self-stake and the stake that is voted to them from nominators. It
also tries to equalize the weights between the validators after each election round.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="off-chain-phragm√©n">Off-Chain Phragm√©n<a href="#off-chain-phragm√©n" class="hash-link" aria-label="Direct link to Off-Chain Phragm√©n" title="Direct link to Off-Chain Phragm√©n">‚Äã</a></h4>
<p>Given the large set of nominators and validators, Phragm√©n&#x27;s method is a difficult optimization
problem. Polkadot uses off-chain workers to compute the result off-chain and submit a transaction to
propose the set of winners. The reason for performing this computation off-chain is to keep a
constant block time of six seconds and prevent long block times at the end of each era, when the
validator election takes place.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Staking Miners</div><div class="admonitionContent_BuS1"><p>The process of computing the optimal solution for NPoS election can be delegated to
<a href="/docs/learn-staking-miner">Staking Miners</a>.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="council-elections">Council Elections<a href="#council-elections" class="hash-link" aria-label="Direct link to Council Elections" title="Direct link to Council Elections">‚Äã</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Deprecated in Polkadot OpenGov</div><div class="admonitionContent_BuS1"><p>Phragmen was used for Council elections in <a href="/docs/learn/learn-governance">Governance v1</a>.</p></div></div>
<p>The Phragm√©n method was also used in the council election mechanism. When you voted for council
members, you could select up to 16 different candidates and then place a reserved bond as the weight
of your vote. Phragm√©n would run once on every election to determine the top candidates to assume
council positions and then again amongst the top candidates to equalize the weight of the votes
behind them as much as possible.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-it-mean-for-node-operators">What does it mean for node operators?<a href="#what-does-it-mean-for-node-operators" class="hash-link" aria-label="Direct link to What does it mean for node operators?" title="Direct link to What does it mean for node operators?">‚Äã</a></h2>
<p>Phragm√©n is something that will run in the background and requires no extra effort from you.
However, it is good to understand how it works since it means that not all the stake you&#x27;ve been
nominated will end up on your validator after an election. Nominators are likely to nominate a few
different validators that they trust to do a good job operating their nodes.</p>
<p>You can use
<a href="https://gist.github.com/tugytur/3531cc618bfbb42f1a6cfb44d9906197" target="_blank" rel="noopener noreferrer">this offline-phragm√©n</a> tool for
predicting the outcome of a validator election ahead of a new election.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-phragm√©n">Understanding Phragm√©n<a href="#understanding-phragm√©n" class="hash-link" aria-label="Direct link to Understanding Phragm√©n" title="Direct link to Understanding Phragm√©n">‚Äã</a></h2>
<p>This section explains the sequential Phragm√©n method in-depth and walks through examples.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-phragm√©n">Basic Phragm√©n<a href="#basic-phragm√©n" class="hash-link" aria-label="Direct link to Basic Phragm√©n" title="Direct link to Basic Phragm√©n">‚Äã</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rationale">Rationale<a href="#rationale" class="hash-link" aria-label="Direct link to Rationale" title="Direct link to Rationale">‚Äã</a></h3>
<p>In order to understand the Weighted Phragm√©n method, we must first understand the basic Phragm√©n
method. There must be some group of candidates, a group of seats they are vying for (which is less
than the size of the group of candidates), and some group of voters. The voters can cast an approval
vote - that is, they can signal approval for any subset of the candidates.</p>
<p>The subset should be a minimum size of one (i.e., one cannot vote for no candidates) and a maximum
size of one less than the number of candidates (i.e., one cannot vote for all candidates). Users are
allowed to vote for all or no candidates, but this will not affect the final result, making votes of
this nature meaningless.</p>
<p>Note that in this example, all voters are assumed to have equal say (that is, their vote does not
count more or less than any other votes). The weighted case will be considered later. However,
weighting can be &quot;simulated&quot; by having multiple voters vote for the same slate of candidates. For
instance, five people voting for a particular candidate is mathematically the same as a single
person with weight <code>5</code> voting for that candidate.</p>
<p>The particular algorithm we call here the &quot;Basic Phragm√©n&quot; was first described by Brill <em>et al.</em> in
their paper
<a href="https://ojs.aaai.org/index.php/AAAI/article/view/10598" target="_blank" rel="noopener noreferrer">&quot;Phragm√©n‚Äôs Voting Methods and Justified Representation&quot;</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm">Algorithm<a href="#algorithm" class="hash-link" aria-label="Direct link to Algorithm" title="Direct link to Algorithm">‚Äã</a></h3>
<p>The Phragm√©n method will iterate, selecting one seat at a time, according to the following rules:</p>
<ol>
<li>Voters submit their ballots, marking which candidates they approve. Ballots will not be modified
after submission.</li>
<li>An initial load of 0 is set for each ballot.</li>
<li>The candidate who wins the next available seat is the one where the ballots of their supporters
would have the <em>least average (mean) cost</em> if that candidate wins.</li>
<li>The <em>n</em> ballots that approved that winning candidate get <em>1/n</em> added to their load.</li>
<li>The load of all ballots that supported the winner of this round are averaged out so that they are
equal.</li>
<li>If there are any more seats, go back to step 3. Otherwise, the selection ends.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">‚Äã</a></h3>
<p>Let&#x27;s walk through an example with four candidates vying for three seats, and five voters.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:   A B C D  L0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1:       X      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2:         X X  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3:       X   X  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4:     X X      0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5:       X X X  0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we can see that voter <code>V1</code> approves only of candidate <code>B</code>, voter <code>V2</code> approves of
candidates <code>C</code> and <code>D</code>, etc. Voters can approve any number of candidates between 1 and
<code>number_of_candidates - 1</code>. An initial &quot;load&quot; of <code>0</code> is set for each ballot (<code>L0</code> = load after round
<code>0</code>, i.e., the &quot;round&quot; before the first round). We shall see shortly how this load is updated and
used to select candidates.</p>
<p>We will now run through an iterative algorithm, with each iteration corresponding to one &quot;seat&quot;.
Since there are three seats, we will walk through three rounds.</p>
<p>For the first round, the winner is simply going to be the candidate with the most votes. Since all
loads are equal, the lowest average load will be the candidate with the highest n, since <code>1/n</code> will
get smaller as <code>n</code> increases. For this first example round, for instance, candidate <code>A</code> had only one
ballot vote for them. Thus, the average load for candidate A is <code>1/1</code>, or 1. Candidate C has two
ballots approving of them, so the average load is <code>1/2</code>. Candidate B has the lowest average load, at
<code>1/4</code> and they get the first seat. Ballots loads are now averaged out, although for the first
iteration, this will not have any effect.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 1 (B)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:   A B C D  L0 L1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1:       X      0  1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2:         X X  0  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3:       X   X  0  1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4:     X X      0  1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5:       X X X  0  1/4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We are now down to candidates <code>A</code>, <code>C</code>, and <code>D</code> for two open seats. There is only one voter (<code>V4</code>)
for <code>A</code>, with load <code>1/4</code>. <code>C</code> has two voters, <code>V2</code> and <code>V5</code>, with loads of <code>0</code> and <code>1/4</code>. <code>D</code> has
three voters approving of them, <code>V2</code>, <code>V3</code>, and <code>V5</code>, with loads of <code>0</code>, <code>1/4</code>, and <code>1/4</code>,
respectively.</p>
<p>If Candidate <code>A</code> wins, the average load would be <code>(1/4 + 1/1) / 1</code>, or <code>5/4</code>. If candidate <code>C</code> wins,
the average load would be <code>((0 + 1/2) + (1/4 + 1/2)) / 2</code>, or <code>5/8</code>. If candidate <code>D</code> wins, the
average load would be <code>((0 + 1/3) + (1/4 + 1/3) + (1/4 + 1/3)) / 3</code>, or <code>1/2</code>. Since <code>1/2</code> is the
lowest average load, candidate D wins the second round.</p>
<p>Now everybody who voted for Candidate <code>D</code> has their load set to the average, <code>1/2</code> of all the loads.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 2 (B, D)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:   A B C D  L0 L1  L2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1:       X      0  1/4 1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2:         X X  0  0   1/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3:       X   X  0  1/4 1/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4:     X X      0  1/4 1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5:       X X X  0  1/4 1/2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is now one seat open and two candidates, <code>A</code> and <code>C</code>. Voter <code>V4</code> is the only one voting for
<code>A</code>, so if <code>A</code> wins then the average load would be <code>(1/4 + 1/1) / 1</code>, or <code>5/4</code>. Voters <code>V2</code> and <code>V5</code>
(both with load <code>1/2</code>) support <code>C</code>, so if <code>C</code> wins the average load would be
<code>((1/2 + 1/2) + (1/2 + 1/2)) / 2</code>, or <code>1</code>. Since the average load would be lower with <code>C</code>, <code>C</code> wins
the final seat.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 3 (B, D, C)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:   A B C D  L0 L1  L2  L3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1:       X      0  1/4 1/4 1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2:         X X  0  0   1/2 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3:       X   X  0  1/4 1/2 1/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4:     X X      0  1/4 1/4 1/4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5:       X X X  0  1/4 1/2 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An interesting characteristic of this calculation is that the total load of all voters will always
equal the number of seats filled in that round. In the zeroth round, load starts at <code>0</code> and there
are no seats filled. After the first round, the total of all loads is <code>1</code>, after the second round it
is <code>2</code>, etc.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="weighted-phragm√©n">Weighted Phragm√©n<a href="#weighted-phragm√©n" class="hash-link" aria-label="Direct link to Weighted Phragm√©n" title="Direct link to Weighted Phragm√©n">‚Äã</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rationale-1">Rationale<a href="#rationale-1" class="hash-link" aria-label="Direct link to Rationale" title="Direct link to Rationale">‚Äã</a></h3>
<p>While this method works well if all voters have equal weight, this is not the case in Polkadot.
Elections for both validators and candidates for the Council are weighted by the number of tokens
held by the voters. This makes elections more similar to a corporate shareholder election than a
traditional political election, where some members have more pull than others. Someone with a single
token will have much less voting power than someone with 100. Although this may seem
anti-democratic, in a pseudonymous system, it is trivial for someone with 100 tokens to create 100
different accounts and spread their wealth to all of their pseudonyms.</p>
<p>Therefore, not only do we want to allow voters to have their preferences expressed in the result,
but do so while keeping as equal a distribution of their stake as possible and express the wishes of
minorities as much as is possible. The Weighted Phragm√©n method allows us to reach these goals.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-1">Algorithm<a href="#algorithm-1" class="hash-link" aria-label="Direct link to Algorithm" title="Direct link to Algorithm">‚Äã</a></h3>
<p>Weighted Phragm√©n is similar to Basic Phragm√©n in that it selects candidates sequentially, one per
round, until the maximum number of candidates are elected. However, it has additional features to
also allocate weight (stake) behind the candidates.</p>
<p><em>NOTE: in terms of validator selection, for the following algorithm, you can think of &quot;voters&quot; as
&quot;nominators&quot; and &quot;candidates&quot; as &quot;validators&quot;.</em></p>
<ol>
<li>Candidates are elected, one per round, and added to the set of successful candidates (they have
won a &quot;seat&quot;). This aspect of the algorithm is very similar to the &quot;basic Phragm√©n&quot; algorithm
described above.</li>
<li>However, as candidates are elected, a weighted mapping is built, defining the weights of each
selection of a validator by each nominator.</li>
</ol>
<p>In more depth, the algorithm operates like so:</p>
<ol>
<li>Create a list of all voters, their total amount of stake, and which validators they support.</li>
<li>Generate an initial edge-weighted graph mapping from voters to candidates, where each edge weight
is the total <em>potential</em> weight (stake) given by that voter. The sum of all potential weight for
a given candidate is called their <em>approval stake</em>.</li>
<li>Now we start electing candidates. For the list of all candidates who have not been elected, get
their score, which is equal to <code>1 / approval_stake</code>.</li>
<li>For each voter, update the score of each candidate they support by adding their total budget
(stake) multiplied by the load of the voter and then dividing by that candidate&#x27;s approval stake
<code>(voter_budget * voter_load / candidate_approval_stake)</code>.</li>
<li>Determine the candidate with the lowest score and elect that candidate. Remove the elected
candidate from the pool of potential candidates.</li>
<li>The load for each edge connecting to the winning candidate is updated, with the edge load set to
the score of the candidate minus the voter&#x27;s load, and the voter&#x27;s load then set to the
candidate&#x27;s score.</li>
<li>If there are more candidates to elect, go to Step 3. Otherwise, continue to step 8.</li>
<li>Now the stake is distributed amongst each nominator who backed at least one elected candidate.
The backing stake for each candidate is calculated by taking the budget of the voter and
multiplying by the edge load then dividing by the candidate load
(<code>voter_budget * edge_load / candidate_load</code>).</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a href="#example-1" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">‚Äã</a></h3>
<p><em>Note: All numbers in this example are rounded off to three decimal places.</em></p>
<p>In the following example, there are five voters and five candidates vying for three potential seats.
Each voter <code>V1 - V5</code> has an amount of stake equal to their number (e.g., <code>V1</code> has stake of 1, <code>V2</code>
has stake of 2, etc.). Every voter is also going to have a <em>load,</em> which initially starts at <code>0</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:    A B C D E  L0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1 (1):  X X        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2 (2):  X X        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3 (3):  X          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4 (4):    X X X    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5 (5):  X     X    0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let us now calculate the approval stake of each of the candidates. Recall that this is merely the
amount of all support for that candidate by all voters.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidate A: 1 + 2 + 3 + 5 = 11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate B: 1 + 2 + 4 = 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate C: 4 = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate D: 4 + 5 = 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate E: 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The first step is easy - candidate <code>E</code> has 0 approval stake and can be ignored from here on out.
They will never be elected.</p>
<p>We can now calculate the initial scores of the candidates, which is <code>1 / approval_stake</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidate A: 1 / 11 = 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate B: 1 / 7 = 0.143</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate C: 1 / 4 = 0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate D: 1 / 9 = 0.111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate E: N/A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For every edge, we are going to calculate the score, which is current score plus the total budget *
the load of the voter divided by the approval stake of the candidate. However, since the load of
every voter starts at 0, and anything multiplied by 0 is 0, any addition will be <code>0 / x</code>, or 0. This
means that this step can be safely ignored for the initial round.</p>
<p>Thus, the best (lowest) score for Round 0 is Candidate A, with a score of <code>0.091</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:    A B C D E  L0 L1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1 (1):  X X        0  0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2 (2):  X X        0  0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3 (3):  X          0  0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4 (4):    X X X    0  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5 (5):  X     X    0  0.091</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 1 (A)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:    A B C D E  L0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1 (1):  X X        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2 (2):  X X        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3 (3):  X          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4 (4):    X X X    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5 (5):  X     X    0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Candidate <code>A</code> is now safe; there is no way that they will lose their seat. Before moving on to the
next round, we need to update the scores on the edges of our graph for any candidates who have not
yet been elected.</p>
<p>We elided this detail in the previous round, since it made no difference to the final scores, but we
should go into depth here to see how scores are updated. We first must calculate the new loads of
the voters, and then calculate the new scores of the candidates.</p>
<p>Any voter who had one of their choices for candidate fill the seat in this round (i.e., voters <code>V1</code>,
<code>V2</code>, <code>V3</code>, and <code>V5</code>, who all voted for <code>A</code>) will have their load increased. This load increase will
blunt the impact of their vote in future rounds, and the edge (which will be used in determining
stake allocation later) is set to the score of the elected candidate minus the <em>current</em> voter load.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">edge_load = elected_candidate_score - voter_load</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">voter_load = elected_candidate_score</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this instance, the score of the elected candidate is <code>0.091</code> and the voter loads are all <code>0</code>. So
for each voter who voted for <code>A</code>, we will calculate a new edge load <code>Voter</code> -&gt; <code>A</code> of:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Edge load: 0.091 - 0 = 0.091</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and a new voter load of:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Voter load: 0.091</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As a reminder, here are the current scores. Loads of the voters are all <code>0</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidate B : 0.143</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate C : 0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate D : 0.111</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, we go through the weighted graph and update the score of the candidate and the load of the
edge, using the algorithm:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">candidate_score = candidate_score + ((voter_budget * voter_load) / candidate_approval_stake)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Without walking through each step, this gives us the following modifications to the scores of the
different candidates.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">V1 updates B to 0.156</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V2 updates B to 0.182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 updates B to 0.182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 updates C to 0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 updates D to 0.111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V5 updates D to 0.162</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After scores are updated, the final scores for the candidates for this round are:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidate B: 0.182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate C: 0.25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate D: 0.162</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>D</code>, with the lowest score, is elected. You will note that even though candidate <code>B</code> had more voters
supporting them, candidate <code>D</code> won the election due to their lower score. This is directly due to
the fact that they had the lowest score, of course, but the root reason behind them having a lower
score was both the greater amount of stake behind them and that voters who did not get one of their
choices in an earlier round (in this example, voter V4) correspond to a higher likelihood of a
candidate being elected.</p>
<p>We then update the loads for the voters and edges as specified above for any voters who voted for
candidate <code>D</code> (viz., <code>V4</code> and <code>V5</code>) using the same formula as above.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 2 (A, D)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:    A B C D E  L0 L1    L2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1 (1):  X X        0  0.091 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2 (2):  X X        0  0.091 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3 (3):  X          0  0.091 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4 (4):    X X X    0  0     0.162</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5 (5):  X     X    0  0.091 0.162</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Following a similar process for Round 2, we start with initial candidate scores of:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Candidate B : 0.143</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidate C : 0.25</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can then update the scores of the remaining two candidates according to the algorithm described
above.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">V1 updates B to 0.156</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V2 updates B to 0.182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 updates B to 0.274</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 updates C to 0.412</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With the lowest score of <code>0.274</code>, Candidate <code>B</code> claims the last open seat. Candidates <code>A</code>, <code>D</code>, and
<code>B</code> have been elected, and candidates <code>C</code> and <code>E</code> are not.</p>
<p>Before moving on, we must perform a final load adjustment for the voters and the graph.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filled seats: 3 (A, D, B)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open Seats: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates:    A B C D E  L0 L1    L2    L3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V1 (1):  X X        0  0.091 0.091 0.274</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V2 (2):  X X        0  0.091 0.091 0.274</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V3 (3):  X          0  0.091 0.091 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V4 (4):    X X X    0  0     0.162 0.274</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Voter V5 (5):  X     X    0  0.091 0.162 0.162</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we have to determine how much stake every voter should allocate to each candidate. This is done
by taking the load of the each edge and dividing it by the voter load, then multiplying by the total
budget of the voter.</p>
<p>In this example, the weighted graph ended up looking like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nominator: V1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to A load= 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to B load= 0.183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nominator: V2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to A load= 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to B load= 0.183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nominator: V3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to A load= 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nominator: V4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to B load= 0.113</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to D load= 0.162</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nominator: V5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to A load= 0.091</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	Edge to D load= 0.071</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For instance, the budget of <code>V1</code> is <code>1</code>, the edge load to <code>A</code> is <code>0.091</code>, and the voter load is
<code>0.274</code>. Using our equation:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">backing_stake (A) = voter_budget * edge_load / voter_load</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can fill these variables in with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">backing_stake (A) = 1 * 0.091 / 0.274 = 0.332</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For <code>V1</code> backing stake of <code>B</code>, you can simply replace the edge load value and re-calculate.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">backing_stake (B) = 1 * 0.183 / 0.274 = 0.668</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that the total amount of all backing stake for a given voter will equal the total budget of the
voter, unless that voter had no candidates elected, in which case it will be 0.</p>
<p>The final results are:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">A is elected with stake 6.807.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D is elected with stake 4.545.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B is elected with stake 3.647.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V1 supports: A with stake: 0.332 and B with stake: 0.668.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V2 supports: A with stake: 0.663 and B with stake: 1.337.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V3 supports: A with stake: 3.0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V4 supports: B with stake: 1.642 and D with stake: 2.358.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V5 supports: A with stake: 2.813 and D with stake: 2.187.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will notice that the total amount of stake for candidates <code>A</code>, <code>D</code>, and <code>B</code> equals (aside from
rounding errors) the total amount of stake of all the voters (<code>1 + 2 + 3 + 4 + 5 = 15</code>). This is
because each voter had at least one of their candidates fill a seat. Any voter who had none of their
candidates selected will also not have any stake in any of the elected candidates.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="optimizations">Optimizations<a href="#optimizations" class="hash-link" aria-label="Direct link to Optimizations" title="Direct link to Optimizations">‚Äã</a></h2>
<p>The results for nominating validators are further optimized for several purposes:</p>
<ol>
<li>To reduce the number of edges, i.e. to minimize the number of validators any nominator selects</li>
<li>To ensure, as much as possible, an even distribution of stake among the validators</li>
<li>Reduce the amount of block computation time</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-description">High-Level Description<a href="#high-level-description" class="hash-link" aria-label="Direct link to High-Level Description" title="Direct link to High-Level Description">‚Äã</a></h3>
<p>After running the weighted Phragm√©n algorithm, a process is run that redistributes the vote amongst
the elected set. This process will never add or remove an elected candidate from the set. Instead,
it reduces the variance in the list of backing stake from the voters to the elected candidates.
Perfect equalization is not always possible, but the algorithm attempts to equalize as much as
possible. It then runs an edge-reducing algorithm to minimize the number of validators per
nominator, ideally giving every nominator a single validator to nominate per era.</p>
<p>To minimize block computation time, the staking process is run as an
<a href="https://docs.substrate.io/reference/how-to-guides/offchain-workers/" target="_blank" rel="noopener noreferrer">off-chain worker</a>. In order to
give time for this off-chain worker to run, staking commands (bond, nominate, etc.) are not allowed
in the last quarter of each era.</p>
<p>These optimizations will not be covered in-depth on this page. For more details, you can view the
<a href="https://github.com/paritytech/polkadot-sdk/tree/master/substrate/frame/elections-phragmen/src/lib.rs" target="_blank" rel="noopener noreferrer">Rust implementation of elections in Substrate</a>,
the
<a href="https://github.com/paritytech/polkadot-sdk/tree/master/substrate/frame/staking/src/lib.rs" target="_blank" rel="noopener noreferrer">Rust implementation of staking in Substrate</a>,
or the <code>seqPhragm√©nwithpostprocessing</code> method in the
<a href="https://github.com/w3f/consensus/tree/master/NPoS" target="_blank" rel="noopener noreferrer">Python reference implementation</a>. If you would
like to dive even more deeply, you can review the
<a href="https://research.web3.foundation/Polkadot/protocols/NPoS/Overview#the-election-process" target="_blank" rel="noopener noreferrer">W3F Research Page on Sequential Phragm√©n Method</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rationale-for-minimizing-the-number-of-validators-per-nominator">Rationale for Minimizing the Number of Validators Per Nominator<a href="#rationale-for-minimizing-the-number-of-validators-per-nominator" class="hash-link" aria-label="Direct link to Rationale for Minimizing the Number of Validators Per Nominator" title="Direct link to Rationale for Minimizing the Number of Validators Per Nominator">‚Äã</a></h3>
<p>Paying out rewards for staking from every validator to all of their nominators can cost a
non-trivial amount of chain resources (in terms of space on chain and resources to compute). Assume
a system with 200 validators and 1000 nominators, where each of the nominators has nominated 10
different validators. Payout would thus require <code>1_000 * 10</code>, or 10_000 transactions. In an ideal
scenario, if every nominator selects a single validator, only 1_000 transactions would need to take
place - an order of magnitude fewer. Empirically, network slowdown at the beginning of an era has
occurred due to the large number of individual payouts by validators to nominators. In extreme
cases, this could be an attack vector on the system, where nominators nominate many different
validators with small amounts of stake in order to slow the system at the next era change.</p>
<p>While this would reduce network and on-chain load, being able to select only a single validator
incurs some diversification costs. If the single validator that a nominator has nominated acts
maliciously, then the nominator incurs a risk of a significant amount of
<a href="/docs/learn-offenses">slashing</a>. Nominators are thus allowed to nominate up to 16 different
validators. However, after the weighted edge-reducing algorithm is run, the number of validators per
nominator is minimized. Nominators are likely to see themselves nominating a single active validator
for an era.</p>
<p>At each era change, as the algorithm runs again, nominators are likely to have a different validator
than they had before (assuming a significant number of selected validators). Therefore, nominators
can diversify against incompetent or corrupt validators causing slashing on their accounts, even if
they only nominate a single validator per era.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rationale-for-maintaining-an-even-distribution-of-stake">Rationale for Maintaining an Even Distribution of Stake<a href="#rationale-for-maintaining-an-even-distribution-of-stake" class="hash-link" aria-label="Direct link to Rationale for Maintaining an Even Distribution of Stake" title="Direct link to Rationale for Maintaining an Even Distribution of Stake">‚Äã</a></h3>
<p>Another issue is that we want to ensure that as equal a distribution of votes as possible amongst
the elected validators or council members. This helps us increase the security of the system by
ensuring that the minimum amount of tokens in order to join the active validator set or council is
as high as possible. For example, assume a result of five validators being elected, where validators
have the following stake: <code>{1_000, 20, 10, 10, 10}</code>, for a total stake of 1_050. In this case, a
potential attacker could join the active validator set with only 11 tokens, and could obtain a
majority of validators with only 33 tokens (since the attacker only has to have enough stake to
&quot;kick out&quot; the three lowest validators).</p>
<p>In contrast, imagine a different result with the same amount of total stake, but with that stake
perfectly equally distributed: <code>{210, 210, 210, 210, 210}</code>. With the same amount of stake, an
attacker would need to stake 633 tokens in order to get a majority of validators, a much more
expensive proposition. Although obtaining an equal distribution is unlikely, the more equal the
distribution, the higher the threshold - and thus the higher the expense - for attackers to gain
entry to the set.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rationale-for-reducing-block-computing-time">Rationale for Reducing Block Computing Time<a href="#rationale-for-reducing-block-computing-time" class="hash-link" aria-label="Direct link to Rationale for Reducing Block Computing Time" title="Direct link to Rationale for Reducing Block Computing Time">‚Äã</a></h3>
<p>Running the Phragm√©n algorithm is time-consuming, and often cannot be completed within the time
limits of production of a single block. Waiting for calculation to complete would jeopardize the
constant block production time of the network. Therefore, as much computation as possible is moved
to an off-chain worker, which validators can work on the problem without impacting block production
time.</p>
<p>To limit the complexity of the election and payout, any given nominator can only
<a href="/docs/chain-state-values#maximum-votes-per-nominator">select a limited number of validators</a>
to nominate.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phragmms-aka-balphragmms">Phragmms (aka Balphragmms)<a href="#phragmms-aka-balphragmms" class="hash-link" aria-label="Direct link to Phragmms (aka Balphragmms)" title="Direct link to Phragmms (aka Balphragmms)">‚Äã</a></h3>
<p><code>Phragmms</code>, formerly known as <code>Balphragmms</code>, is a new election rule inspired by Phragm√©n and
developed in-house for Polkadot. In general, election rules on blockchains is an active topic of
research. This is due to the conflicting requirements for election rules and blockchains: elections
are computationally expensive, but blockchains are computationally limited. Thus, this work
constitutes state of the art in terms of optimization.</p>
<p>Proportional representation is a very important property for a decentralized network to have in
order to maintain a sufficient level of decentralization. While this is already provided by the
currently implemented <code>seqPhragmen</code>, this new election rule provides the advantage of the added
security guarantee described below. As far as we can tell, at the time of writing, Polkadot and
Kusama are the only blockchain networks that implement an election rule that guarantees proportional
representation.</p>
<p>The security of a distributed and decentralized system such as Polkadot is directly related to the
goal of avoiding <em>overrepresentation</em> of any minority. This is a stark contrast to traditional
approaches to proportional representation axioms, which typically only seek to avoid
underrepresentation.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="maximin-support-objective-and-pjr">Maximin Support Objective and PJR<a href="#maximin-support-objective-and-pjr" class="hash-link" aria-label="Direct link to Maximin Support Objective and PJR" title="Direct link to Maximin Support Objective and PJR">‚Äã</a></h4>
<p>This new election rule aims to achieve a constant-factor approximation guarantee for the <em>maximin
support objective</em> and the closely related <em>proportional justified representation</em> (PJR) property.</p>
<p>The maximin support objective is based on maximizing the support of the least-supported elected
candidate, or in the case of Polkadot and Kusama, maximizing the least amount of stake backing
amongst elected validators. This security-based objective translates to a security guarantee for
NPoS and makes it difficult for an adversarial whale‚Äôs validator nodes to be elected. The <code>Phragmms</code>
rule, and the guarantees it provides in terms of security and proportionality, have been formalized
in a <a href="https://arxiv.org/pdf/2004.12990.pdf" target="_blank" rel="noopener noreferrer">peer-reviewed paper</a>).</p>
<p>The PJR property considers the proportionality of the voter‚Äôs decision power. The property states
that a group of voters with cohesive candidate preferences and a large enough aggregate voting
strength deserve to have a number of representatives proportional to the group‚Äôs vote strength.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="comparing-sequential-phragm√©n-mms-and-phragmms">Comparing Sequential Phragm√©n, MMS, and Phragmms<a href="#comparing-sequential-phragm√©n-mms-and-phragmms" class="hash-link" aria-label="Direct link to Comparing Sequential Phragm√©n, MMS, and Phragmms" title="Direct link to Comparing Sequential Phragm√©n, MMS, and Phragmms">‚Äã</a></h4>
<p><em>Sequential Phragm√©n</em> (<code>seqPhragmen</code>) and <code>MMS</code> are two efficient election rules that both achieve
PJR.</p>
<p>Currently, Polkadot employs the <code>seqPhragmen</code> method for validator and council elections. Although
<code>seqPhramen</code> has a very fast runtime, it does not provide constant-factor approximation for the
maximin support problem. This is due to <code>seqPhramen</code> only performing an <em>approximate</em> rebalancing of
the distribution of stake.</p>
<p>In contrast, <code>MMS</code> is another standard greedy algorithm that simultaneously achieves the PJR
property and provides a constant factor approximation for maximin support, although with a
considerably slower runtime. This is because for a given partial solution, <code>MMS</code> computes a balanced
edge weight vector for each possible augmented committee when a new candidate is added, which is
computationally expensive.</p>
<p>We introduce a new heuristic inspired by <code>seqPhragmen</code>, <code>PhragMMS</code>, which maintains a comparable
runtime to <code>seqPhragmen</code>, offers a constant-factor approximation guarantee for the maximin support
objective, and satisfies PJR. This is the fastest known algorithm to achieve a constant-factor
guarantee for maximin support.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-new-election-rule-phragmms">The New Election Rule: Phragmms<a href="#the-new-election-rule-phragmms" class="hash-link" aria-label="Direct link to The New Election Rule: Phragmms" title="Direct link to The New Election Rule: Phragmms">‚Äã</a></h4>
<p><code>Phragmms</code> is an iterative greedy algorithm that starts with an empty committee and alternates
between the <code>Phragmms</code> heuristic for inserting a new candidate and <em>rebalancing</em> by replacing the
weight vector with a balanced one. The main differentiator between <code>Phragmms</code> and <code>seqPhragmen</code> is
that the latter only perform an approximate rebalancing. Details can be found in
<a href="#rationale-for-maintaining-an-even-distribution-of-stake">Balanced Stake Distribution</a>.</p>
<p>The computation is executed by off-chain workers privately and separately from block production, and
the validators only need to submit and verify the solutions on-chain. Relative to a committee <em>A</em>,
the score of an unelected candidate <em>c</em> is an easy-to-compute rough estimate of what would be the
size of the least stake backing if we added <em>c</em> to committee <em>A</em>. Observing on-chain, only one
solution needs to be tracked at any given time, and a block producer can submit a new solution in
the block only if the block passes the verification test, consisting of checking:</p>
<ol>
<li>Feasibility,</li>
<li>Balance and</li>
<li>Local Optimality - The least stake backing of <em>A</em> is higher than the highest score among
unelected candidates</li>
</ol>
<p>If the tentative solution passes the tests, then it replaces the current solution as the tentative
winner. The official winning solution is declared at the end of the election window.</p>
<p>A powerful feature of this algorithm is the fact that both its approximation guarantee for maximin
support and the above checks passing can be efficiently verified in linear time. This allows for a
more scalable solution for secure and proportional committee elections. While <code>seqPhragmen</code> also has
a notion of score for unelected candidates, <code>Phragmms</code> can be seen as a natural complication of the
<code>seqPhragmen</code> algorithm, where <code>Phragmms</code> always grants higher score values to candidates and thus
inserts them with higher support values.</p>
<p><strong>To summarize, the main differences between the two rules are:</strong></p>
<ul>
<li>In <code>seqPhragmen</code>, lower scores are better, whereas in <code>Phragmms</code>, higher scores are better.</li>
<li>Inspired by <code>seqPhragmen</code>, the scoring system of <code>Phragmms</code> can be considered to be more intuitive
and does a better job at estimating the value of adding a candidate to the current solution, and
hence leads to a better candidate-selection heuristic.</li>
<li>Unlike <code>seqPhragmen</code>, in <code>Phragmms</code>, the edge weight vector <em>w</em> is completely rebalanced after
each iteration of the algorithm.</li>
</ul>
<p>The <code>Phragmms</code> election rule is currently being implemented on Polkadot. Once completed, it will
become one of the most sophisticated election rules implemented on a blockchain. For the first time,
this election rule will provide both fair representation (PJR) and security (constant-factor
approximation for the maximin support objection) to a blockchain network.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-2">Algorithm<a href="#algorithm-2" class="hash-link" aria-label="Direct link to Algorithm" title="Direct link to Algorithm">‚Äã</a></h4>
<p>The <code>Phragmms</code> algorithm iterates through the available seats, starting with an empty committee of
size <em>k</em>:</p>
<ol>
<li>
<p>Initialize an empty committee <em>A</em> and zero edge weight vector <em>w = 0</em>.</p>
</li>
<li>
<p>Repeat <em>k</em> times:</p>
<ul>
<li>Find the unelected candidate with highest score and add it to committee <em>A</em>.</li>
<li>Re-balance the weight vector <em>w</em> for the new committee <em>A</em>.</li>
</ul>
</li>
<li>
<p>Return <em>A</em> and <em>w</em>.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="external-resources">External Resources<a href="#external-resources" class="hash-link" aria-label="Direct link to External Resources" title="Direct link to External Resources">‚Äã</a></h2>
<ul>
<li><a href="https://arxiv.org/pdf/2004.12990.pdf" target="_blank" rel="noopener noreferrer">Phragmms</a> - W3F research paper that expands on the
sequential Phragm√©n method.</li>
<li><a href="https://research.web3.foundation/Polkadot/protocols/NPoS/Overview" target="_blank" rel="noopener noreferrer">W3F Research Page on NPoS</a> -
An overview of Nominated Proof of Stake as its applied to Polkadot.</li>
<li><a href="https://github.com/w3f/consensus/tree/master/NPoS" target="_blank" rel="noopener noreferrer">Python Reference Implementations</a> - Python
implementations of Simple and Complicated Phragm√©n methods.</li>
<li><a href="https://github.com/paritytech/polkadot-sdk/tree/master/substrate/frame/staking/src/lib.rs" target="_blank" rel="noopener noreferrer">Substrate Implementation</a> -
Rust implementation used in Substrate.</li>
<li><a href="https://arxiv.org/pdf/1611.08826.pdf" target="_blank" rel="noopener noreferrer">Phragm√©n&#x27;s and Thiele&#x27;s Election Methods</a> - 95-page paper
explaining Phragm√©n&#x27;s election methods in detail.</li>
<li><a href="https://ojs.aaai.org/index.php/AAAI/article/view/10598" target="_blank" rel="noopener noreferrer">Phragm√©n‚Äôs Voting Methods and Justified Representation</a> -
This paper by Brill <em>et al.</em> is the source for the simple Phragm√©n method, along with proofs about
its properties.</li>
<li><a href="https://github.com/kianenigma/offline-phragmen" target="_blank" rel="noopener noreferrer">Offline Phragm√©n</a> - Script to generate the
Phragm√©n validator election outcome before the start of an era.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/w3f/polkadot-wiki/edit/master/docs/learn/learn-phragmen.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-12-03T10:55:55.000Z" itemprop="dateModified">Dec 3, 2024</time></b> by <b>cuibuwei</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/learn-cryptography"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cryptography</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/learn-polkadotjs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Polkadot-JS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#npos-election-algorithms" class="table-of-contents__link toc-highlight">NPoS Election Algorithms</a></li><li><a href="#what-is-the-sequential-phragm√©n-method" class="table-of-contents__link toc-highlight">What is the sequential Phragm√©n method?</a><ul><li><a href="#validator-elections" class="table-of-contents__link toc-highlight">Validator Elections</a></li><li><a href="#council-elections" class="table-of-contents__link toc-highlight">Council Elections</a></li></ul></li><li><a href="#what-does-it-mean-for-node-operators" class="table-of-contents__link toc-highlight">What does it mean for node operators?</a></li><li><a href="#understanding-phragm√©n" class="table-of-contents__link toc-highlight">Understanding Phragm√©n</a><ul><li><a href="#basic-phragm√©n" class="table-of-contents__link toc-highlight">Basic Phragm√©n</a></li><li><a href="#rationale" class="table-of-contents__link toc-highlight">Rationale</a></li><li><a href="#algorithm" class="table-of-contents__link toc-highlight">Algorithm</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#weighted-phragm√©n" class="table-of-contents__link toc-highlight">Weighted Phragm√©n</a></li><li><a href="#rationale-1" class="table-of-contents__link toc-highlight">Rationale</a></li><li><a href="#algorithm-1" class="table-of-contents__link toc-highlight">Algorithm</a></li><li><a href="#example-1" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#optimizations" class="table-of-contents__link toc-highlight">Optimizations</a><ul><li><a href="#high-level-description" class="table-of-contents__link toc-highlight">High-Level Description</a></li><li><a href="#rationale-for-minimizing-the-number-of-validators-per-nominator" class="table-of-contents__link toc-highlight">Rationale for Minimizing the Number of Validators Per Nominator</a></li><li><a href="#rationale-for-maintaining-an-even-distribution-of-stake" class="table-of-contents__link toc-highlight">Rationale for Maintaining an Even Distribution of Stake</a></li><li><a href="#rationale-for-reducing-block-computing-time" class="table-of-contents__link toc-highlight">Rationale for Reducing Block Computing Time</a></li><li><a href="#phragmms-aka-balphragmms" class="table-of-contents__link toc-highlight">Phragmms (aka Balphragmms)</a></li></ul></li><li><a href="#external-resources" class="table-of-contents__link toc-highlight">External Resources</a></li></ul></div></div></div></div></main></div></div></div><footer class="nav-footer spacer-y-4" id="footer"><div class="container-custom container"><div class="footer-legal align-items-end row"><div class="mb-2 mb-lg-0 col-lg-2"><a class="navbar-brand" href="https://polkadot.network/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 6593.8 250" height="31" alt="Polkadot Network"><path fill="#fff" fill-rule="evenodd" d="m314.09 211.135 10.869-51.091c5.97.699 13.748 1.352 24.571 1.352 25.288 0 45.928-6.905 60.269-19.141C424.16 130 432.105 112.48 432.105 91.484c0-14.241-3.802-26.216-10.959-35.538-7.158-9.322-17.607-15.907-30.754-19.48-7.649-2.084-16.213-3.156-25.591-3.156-9.933 0-29.373 2.666-41.094 4.645l-.755.124-36.899 173.063h28.031zm34.227-75.517c-3.808 0-7.197-.059-10.314-.202a111 111 0 0 1-7.719-.614l15.813-74.126c5.047-.719 12.14-1.594 19.433-1.594 4.499 0 8.604.366 12.315 1.071 7.144 1.359 12.824 3.979 17.077 7.65 6.429 5.553 9.727 13.653 9.727 23.922 0 13.164-4.725 24.08-14.038 31.729-9.339 7.676-23.422 12.164-42.294 12.164" clip-rule="evenodd"></path><path fill="#fff" d="M560.872 211.135 598.119 36.42h-28.043l-37.241 174.715h28.044z"></path><path fill="#fff" fill-rule="evenodd" d="m914.877 99.512 13.567-63.092h28.069l-24.597 114.537c-2.188 10.034-4.098 21.427-4.098 28.142 0 2.751.361 4.854 1.084 6.232.348.673.774 1.144 1.258 1.451.478.307 1.085.49 1.872.49 1.02 0 2.285-.471 3.776-1.47 1.478-.987 3.072-2.424 4.724-4.181 3.234-3.436 6.584-7.996 9.559-12.536a52 52 0 0 1-.026-1.731c0-18.736 6.693-37.961 18.311-52.516 11.623-14.561 28.224-24.504 48.024-24.504 13.73 0 24.71 4.814 32.25 13.065 7.53 8.238 11.54 19.794 11.54 33.114 0 31.821-19.08 65.013-48.92 74.564a57.2 57.2 0 0 1-17.413 2.704c-6.067 0-11.599-.941-16.542-2.717-8.539-3.051-15.271-8.571-19.905-15.888-5.738 7.258-12.14 12.791-19.292 15.861-4.13 1.784-8.571 2.744-13.114 2.744s-8.585-.934-12.018-2.783c-7.274-3.926-11.495-11.811-12.069-22.884-6.397 10.505-15.032 18.867-26.082 22.95-4.75 1.75-9.913 2.704-15.528 2.704-5.254 0-10.069-.954-14.387-2.724-9.042-3.698-15.8-10.897-19.756-20.062-6.022 9.956-12.579 16.613-19.969 20.042-3.963 1.843-8.223 2.744-12.547 2.744s-8.165-.96-11.405-2.783c-6.931-3.9-10.914-11.543-11.656-21.335-5.964 9.635-13.947 17.481-24.371 21.407-4.647 1.751-9.752 2.711-15.354 2.711-5.228 0-10.082-.941-14.458-2.718-5.447-2.208-9.713-5.827-12.985-10.341-5.822 5.795-12.638 10.021-19.937 12.288-8.133 2.522-17.059 2.613-25.398-.836-8.448-3.501-15.167-10.178-19.446-19.147-2.188-4.593-4.395-10.047-6.519-15.306a879 879 0 0 0-1.768-4.364c-1.291-3.149-2.582-6.232-3.918-9.204a77 77 0 0 1-8.668 1.3L607 211.253h-28.94l37.434-175.604h28.947l-20.763 97.382c14.605-4.253 34.742-16.286 48.58-45.996l27.405 13.078c-12.786 27.457-30.483 44.292-47.819 54.025a337 337 0 0 1 3.504 8.303c.723 1.77 1.407 3.456 2.059 5.069 2.053 5.07 3.795 9.394 5.577 13.118 1.574 3.299 3.394 4.605 4.763 5.167 1.484.614 3.653.85 6.499-.032 5.738-1.784 13.309-8.075 17.052-20.134l2.743-12.157c1.071-8.003 3.092-15.287 5.654-20.65 12.256-25.647 36.743-42.985 63.857-42.985 8.823 0 18.04 2.137 26.095 5.364 8.048 3.227 15.038 7.584 19.362 12.105l.426.444-.135.601c-.859 3.802-1.937 8.44-3.118 13.529-1.917 8.244-4.105 17.677-6.093 26.699-1.6 7.29-3.059 14.287-4.124 20.127-1.065 5.873-1.704 10.491-1.704 13.072 0 1.946.401 3.338 1.007 4.213.568.823 1.375 1.261 2.472 1.261 1.549 0 3.382-.856 5.499-2.835 2.104-1.966 4.37-4.926 6.771-8.839 4.795-7.826 10.029-19.291 15.58-33.773 10.23-31.07 36.498-51.478 62.825-51.478 12.082 0 20.498 3.62 26.488 9.172zM773.602 140.91l5.131-21.715c-4.783-2.855-10.211-4.788-17.136-4.788-12.044 0-22.648 6.728-30.283 16.756-7.642 10.027-12.218 23.25-12.218 35.962 0 6.441 1.536 11.667 4.331 15.26 2.769 3.561 6.854 5.625 12.237 5.625 8.068 0 15.774-4.122 22.377-12.105 6.609-7.996 12.069-19.807 15.561-34.989zm135.021-12.948 1.316-6.396c-4.86-3.802-11.475-6.663-20.091-6.663-11.547 0-21.732 6.539-29.07 16.404-7.338 9.87-11.747 22.968-11.747 35.818 0 6.696 1.543 11.922 4.247 15.456 2.679 3.495 6.584 5.435 11.598 5.435 9.191 0 18.169-5.918 25.882-16.514 7.699-10.576 14.012-25.647 17.865-43.534zm73.81 53.724c2.975 3.881 7.596 6.317 14.321 6.317 9.666 0 18.516-6.402 25.016-15.965 6.48-9.545 10.47-22.048 10.47-33.8 0-6.337-1.43-11.87-4.43-15.796-2.97-3.881-7.59-6.324-14.33-6.324-9.66 0-18.507 6.461-25.006 16.057-6.48 9.577-10.469 22.087-10.469 33.722 0 6.337 1.427 11.863 4.428 15.789" clip-rule="evenodd"></path><path fill="#fff" d="m1155.44 178.244-.65.953c-5.14 7.604-12.13 16.084-16.9 20.336-3.89 3.489-8.36 6.729-13.29 9.238-5.95 3.044-12.59 5.004-19.69 5.004-6.04 0-11.25-1.085-15.65-3.097-11.93-5.455-17.48-17.573-17.48-32.31 0-5.834.66-11.517 1.4-15.979v-.039l.02-.098c.27-1.562.53-2.979.79-4.194l8.68-40.718h-19.19l5.23-24.55h19.05l10.17-47.166h28.05l-10.22 47.166h33.98l-5.22 24.55h-34.09l-8.78 41.678c-.02.091-.03.176-.05.261v.033l-.01.013c-.02.098-.03.19-.05.287h-.01l-.01.092c-1.15 5.86-2.03 11.132-2.03 15.482 0 4.031.82 7.134 2.27 9.192 1.42 2.012 3.5 3.135 6.3 3.135 3.21 0 6.13-1.162 9.41-3.521 3.29-2.378 6.86-5.912 11.35-10.563.35-.398 2.55-3.096 4.93-6.023l1.92-2.352z"></path><path fill="#fff" fill-rule="evenodd" d="M490.115 90.34c-19.795 0-36.402 9.937-48.025 24.504-11.618 14.555-18.311 33.774-18.311 52.516 0 20.963 9.772 37.465 27.269 43.717 4.937 1.77 10.462 2.704 16.523 2.704 6.06 0 11.92-.947 17.381-2.691 29.857-9.531 48.961-42.737 48.961-74.57 0-13.32-4.014-24.877-11.547-33.114-7.544-8.245-18.523-13.065-32.251-13.065m-19.634 97.663c-6.725 0-11.346-2.443-14.321-6.317-3.008-3.926-4.428-9.452-4.428-15.789 0-11.635 3.989-24.138 10.469-33.722 6.499-9.596 15.348-16.057 25.01-16.057 6.731 0 11.352 2.443 14.321 6.324 3.008 3.926 4.428 9.459 4.428 15.796 0 11.752-3.989 24.255-10.469 33.8-6.493 9.563-15.348 15.965-25.01 15.965" clip-rule="evenodd"></path><path fill="#fff" d="M127.287 52.399c24.104 0 43.643-11.509 43.643-25.706S151.391.987 127.287.987 83.644 12.496 83.644 26.693s19.54 25.706 43.643 25.706M127.287 245.987c24.104 0 43.643-11.509 43.643-25.706s-19.539-25.706-43.643-25.706-43.643 11.509-43.643 25.706 19.54 25.706 43.643 25.706M66.459 87.94c12.051-21.128 11.977-44.008-.168-51.105s-31.759 4.278-43.81 25.406-11.977 44.008.167 51.105 31.759-4.278 43.81-25.406M232.112 184.734c12.052-21.128 11.974-44.01-.173-51.108-12.147-7.099-31.764 4.274-43.816 25.402s-11.974 44.01.173 51.109c12.147 7.098 31.764-4.275 43.816-25.403M66.292 210.143c12.147-7.098 12.224-29.98.173-51.108s-31.67-32.501-43.816-25.403c-12.148 7.099-12.225 29.981-.173 51.109s31.669 32.501 43.816 25.402M231.935 113.341c12.148-7.098 12.225-29.98.173-51.108s-31.669-32.501-43.816-25.403c-12.147 7.099-12.225 29.98-.173 51.109 12.052 21.128 31.669 32.501 43.816 25.402"></path></svg></a></div><div class="col-lg-6"><ul class="list-unstyled d-flex flex-wrap list-pipe-separator mt-2"><li><a href="https://web3.foundation" class="text-white text-small" target="_blank" rel="noopener noreferrer">¬© 2025 Web3 Foundation</a></li><li><a href="https://polkadot.network/legal-disclosures" class="text-white text-small" target="_blank" rel="noopener noreferrer">Legal Disclosures</a></li><li><a href="https://polkadot.network/disclaimer" class="text-white text-small" target="_blank" rel="noopener noreferrer">Disclaimer</a></li><li><a href="https://polkadot.network/privacy" class="text-white text-small" target="_blank" rel="noopener noreferrer">Privacy</a></li></ul></div><div class="px-lg-0 col"><ul class="list-social-links mt-5 mt-lg-0 justify-content-lg-end"><li class="text-white mr-2 mr-lg-0 mr-xl-2"><a href="https://twitter.com/Polkadot" target="_blank" rel="noopener noreferrer"><i class="socicon-twitter"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2"><a href="https://www.reddit.com/r/polkadot" target="_blank" rel="noopener noreferrer"><i class="socicon-reddit"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2"><a href="https://github.com/paritytech/polkadot-sdk" target="_blank" rel="noopener noreferrer"><i class="socicon-github"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2"><a href="https://www.youtube.com/channel/UCB7PbjuZLEba_znc7mEGNgw" target="_blank" rel="noopener noreferrer"><i class="socicon-youtube"></i></a></li><li class="text-white mr-2 mr-lg-0 mr-xl-2"><a href="https://dot.li/discord" target="_blank" rel="noopener noreferrer"><i class="socicon-discord"></i></a></li></ul></div></div></div></footer></div>
</body>
</html>